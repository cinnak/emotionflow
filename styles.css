/* ============================================
   EmotionFlow - Emotional Release Design
   Based on psychological research for true catharsis
   ============================================ */

/* Design Tokens - Emotional Color Journeys */
:root {
  /* Background - Deeper, darker for pre-release emotional weight */
  --void-deep: #0d1219;
  --void-mid: #121a24;
  --void-light: #1a2535;

  /* SADNESS - Oceanic Release Journey */
  --sadness-heavy: #1a3a52;
  --sadness-primary: #4a7a9a;
  --sadness-peak: #6db0d5;
  --sadness-peace: #c8e4f6;
  --sadness-glow: rgba(109, 176, 213, 0.5);
  --sadness-ambient: rgba(109, 176, 213, 0.12);

  /* ANGER - Volcanic Release Journey */
  --anger-heavy: #6c2a2a;
  --anger-primary: #f0805a;
  --anger-peak: #ffa070;
  --anger-peace: #ffdcc7;
  --anger-glow: rgba(240, 128, 90, 0.5);
  --anger-ambient: rgba(240, 128, 90, 0.12);

  /* ANXIETY - Storm Clearing Journey */
  --anxiety-heavy: #3d2b5e;
  --anxiety-primary: #ab7cc8;
  --anxiety-peak: #d9b8f0;
  --anxiety-peace: #f0e3ff;
  --anxiety-glow: rgba(171, 124, 200, 0.5);
  --anxiety-ambient: rgba(171, 124, 200, 0.12);

  /* FEAR - Trembling to Calm Journey */
  --fear-heavy: #1a3d3a;
  --fear-primary: #3a8a7a;
  --fear-peak: #5cb8a5;
  --fear-peace: #a8e8d8;
  --fear-glow: rgba(92, 184, 165, 0.5);
  --fear-ambient: rgba(92, 184, 165, 0.12);

  /* SHAME - Hiding to Emerging Journey */
  --shame-heavy: #3d2a1a;
  --shame-primary: #8a6a3a;
  --shame-peak: #b8955a;
  --shame-peace: #e8d4a8;
  --shame-glow: rgba(184, 149, 90, 0.5);
  --shame-ambient: rgba(184, 149, 90, 0.12);

  /* LONELINESS - Seeking Connection Journey */
  --loneliness-heavy: #2a1a3d;
  --loneliness-primary: #6a3a8a;
  --loneliness-peak: #9a5ab8;
  --loneliness-peace: #d4a8e8;
  --loneliness-glow: rgba(154, 90, 184, 0.5);
  --loneliness-ambient: rgba(154, 90, 184, 0.12);

  /* Default emotion */
  --current-emotion: var(--sadness-primary);
  --current-heavy: var(--sadness-heavy);
  --current-peak: var(--sadness-peak);
  --current-peace: var(--sadness-peace);
  --current-glow: var(--sadness-glow);
  --current-ambient: var(--sadness-ambient);

  /* Typography */
  --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;

  /* Text Colors */
  --text-primary: #d1d9e6;
  --text-secondary: #94a3b8;
  --text-muted: #64748b;

  /* Spacing */
  --space-xs: 0.25rem;
  --space-sm: 0.5rem;
  --space-md: 1rem;
  --space-lg: 1.5rem;
  --space-xl: 2rem;
  --space-2xl: 3rem;
  --space-3xl: 4rem;

  /* Easing Functions */
  --ease-arrive: cubic-bezier(0.23, 1, 0.32, 1);
  --ease-weighted: cubic-bezier(0.34, 1.56, 0.64, 1);
  --ease-release: cubic-bezier(0.11, 0, 0.5, 0);
  --ease-settle: cubic-bezier(0.25, 0.46, 0.45, 0.94);
  --ease-breathe: cubic-bezier(0.4, 0, 0.6, 1);
}

/* ============================================
   Base & Reset
   ============================================ */

*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}

body {
  font-family: var(--font-family);
  font-size: 1rem;
  font-weight: 400;
  line-height: 1.6;
  color: var(--text-primary);
  background: var(--void-deep);
  min-height: 100vh;
  min-height: 100dvh;
  overflow-x: hidden;
  position: relative;
  transition: background-color 2.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Focus styles */
:focus-visible {
  outline: 2px solid var(--current-emotion);
  outline-offset: 4px;
  border-radius: 4px;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ============================================
   Ambient Background - Breathing Orbs
   ============================================ */

.ambient-background {
  position: fixed;
  inset: 0;
  z-index: 0;
  overflow: hidden;
  pointer-events: none;
  transition: all 1.5s var(--ease-breathe);
}

.gradient-orb {
  position: absolute;
  border-radius: 50%;
  filter: blur(120px);
  opacity: 0.45;
  transition: all 1.5s var(--ease-breathe);
}

.orb-1 {
  width: 70vw;
  height: 70vw;
  top: -25%;
  left: -15%;
  background: radial-gradient(circle, var(--current-emotion) 0%, transparent 70%);
  animation: breathe-orb-1 8s var(--ease-breathe) infinite;
}

.orb-2 {
  width: 60vw;
  height: 60vw;
  bottom: -20%;
  right: -15%;
  background: radial-gradient(circle, var(--current-peak) 0%, transparent 70%);
  animation: breathe-orb-2 10s var(--ease-breathe) infinite;
}

.orb-3 {
  width: 40vw;
  height: 40vw;
  top: 40%;
  left: 30%;
  background: radial-gradient(circle, var(--current-peace) 0%, transparent 70%);
  opacity: 0.25;
  animation: breathe-orb-3 12s var(--ease-breathe) infinite;
}

@keyframes breathe-orb-1 {
  0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.4; }
  50% { transform: translate(5%, 10%) scale(1.05); opacity: 0.5; }
}

@keyframes breathe-orb-2 {
  0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.35; }
  50% { transform: translate(-10%, -5%) scale(1.08); opacity: 0.5; }
}

@keyframes breathe-orb-3 {
  0%, 100% { transform: translate(0, 0) scale(1); }
  50% { transform: translate(3%, -8%) scale(1.03); }
}

/* ============================================
   Particle Canvas
   ============================================ */

#particleCanvas {
  position: fixed;
  inset: 0;
  z-index: 100;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.5s var(--ease-arrive);
}

#particleCanvas.active {
  opacity: 1;
}

/* ============================================
   Main Container
   ============================================ */

.container {
  width: 100%;
  max-width: 640px;
  margin: 0 auto;
  padding: var(--space-xl) var(--space-lg);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  position: relative;
  z-index: 1;
}

/* ============================================
   Header
   ============================================ */

.header {
  text-align: center;
  padding: var(--space-2xl) 0 var(--space-xl);
  animation: fade-in-down 1s var(--ease-arrive);
  transition: opacity 0.5s, transform 0.5s;
}

/* Hide header during release */
body[data-state="releasing"] .header {
  opacity: 0;
  pointer-events: none;
}

.logo {
  display: inline-flex;
  align-items: center;
  gap: var(--space-sm);
  margin-bottom: var(--space-md);
}

.logo-icon {
  font-size: 2.5rem;
  animation: gentle-breathe 4s var(--ease-breathe) infinite;
}

.logo-text {
  font-size: 1.75rem;
  font-weight: 500;
  letter-spacing: -0.02em;
  background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.tagline {
  font-size: 0.875rem;
  color: var(--text-secondary);
  font-weight: 300;
  letter-spacing: 0.02em;
}

/* ============================================
   Emotion Selector
   ============================================ */

.emotion-selector {
  display: flex;
  gap: var(--space-sm);
  justify-content: center;
  flex-wrap: wrap;
  margin-bottom: var(--space-xl);
  animation: fade-in-up 1s var(--ease-arrive) 0.1s both;
  transition: opacity 0.5s, transform 0.5s;
}

/* Hide emotion selector during release */
body[data-state="releasing"] .emotion-selector {
  opacity: 0;
  pointer-events: none;
}

.emotion-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-xs);
  padding: var(--space-sm) var(--space-md);
  border: 1px solid rgba(255, 255, 255, 0.08);
  background: rgba(255, 255, 255, 0.02);
  border-radius: 1rem;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.3s var(--ease-arrive);
}

.emotion-btn:hover {
  border-color: rgba(255, 255, 255, 0.15);
  background: rgba(255, 255, 255, 0.04);
  color: var(--text-secondary);
  transform: translateY(-2px);
}

.emotion-btn.active {
  border-color: var(--current-emotion);
  background: var(--current-glow);
  color: var(--text-primary);
  box-shadow: 0 0 30px var(--current-ambient);
}

.emotion-icon {
  font-size: 1.25rem;
}

.emotion-label {
  font-size: 0.75rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* ============================================
   Input Section
   ============================================ */

.input-section {
  animation: fade-in-up 1s var(--ease-arrive) 0.2s both;
}

.emotion-well {
  position: relative;
  padding: var(--space-xl);
  background: rgba(255, 255, 255, 0.02);
  border-radius: 1.5rem;
  transition: all 0.6s var(--ease-arrive);
  border: 1px solid rgba(255, 255, 255, 0.06);
}

.emotion-well:focus-within {
  background: rgba(255, 255, 255, 0.03);
  border-color: var(--current-emotion);
  box-shadow: 0 0 60px var(--current-ambient), inset 0 0 60px var(--current-ambient);
  transform: scale(1.01);
}

/* Animated breathing borders */
.well-border {
  position: absolute;
  background: var(--current-emotion);
  opacity: 0;
  transition: opacity 0.6s var(--ease-arrive), background-color 1.5s var(--ease-breathe);
}

.emotion-well:focus-within .well-border {
  opacity: 0.5;
}

.well-border.top {
  top: 0;
  left: var(--space-lg);
  right: var(--space-lg);
  height: 2px;
  animation: border-breathe 4s var(--ease-breathe) infinite;
}

.well-border.bottom {
  bottom: 0;
  left: var(--space-lg);
  right: var(--space-lg);
  height: 2px;
  animation: border-breathe 4s var(--ease-breathe) infinite 0.5s;
}

.well-border.left {
  left: 0;
  top: var(--space-lg);
  bottom: var(--space-lg);
  width: 2px;
  animation: border-breathe 4s var(--ease-breathe) infinite 1s;
}

.well-border.right {
  right: 0;
  top: var(--space-lg);
  bottom: var(--space-lg);
  width: 2px;
  animation: border-breathe 4s var(--ease-breathe) infinite 1.5s;
}

@keyframes border-breathe {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.7; }
}

.emotion-input {
  width: 100%;
  min-height: 180px;
  padding: 0;
  border: none;
  background: transparent;
  color: var(--text-primary);
  font-family: var(--font-family);
  font-size: 1.125rem;
  line-height: 1.7;
  resize: vertical;
}

.emotion-input::placeholder {
  color: var(--text-muted);
  opacity: 0.7;
}

.emotion-input:focus {
  outline: none;
}

/* Input Footer */
.input-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-md) var(--space-lg) 0;
}

.char-indicator {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-variant-numeric: tabular-nums;
}

.char-divider {
  margin: 0 4px;
  opacity: 0.5;
}

.input-status {
  font-size: 0.75rem;
  color: var(--text-muted);
  transition: color 0.3s var(--ease-arrive);
}

.input-status.typing {
  color: var(--text-secondary);
}

.input-status.ready {
  color: var(--current-emotion);
}

/* ============================================
   Hold-to-Release Button
   ============================================ */

.release-btn-container {
  margin-top: var(--space-xl);
  display: flex;
  justify-content: center;
}

.release-btn {
  position: relative;
  width: 100%;
  max-width: 320px;
  padding: var(--space-lg) var(--space-xl);
  border: none;
  border-radius: 3rem;
  cursor: not-allowed;
  transition: all 0.3s var(--ease-arrive);
  background: rgba(255, 255, 255, 0.05);
  color: var(--text-muted);
}

.release-btn:disabled {
  opacity: 0.4;
}

.release-btn.ready {
  cursor: pointer;
  background: var(--current-heavy);
  color: var(--text-primary);
}

.release-btn.ready::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 3rem;
  background: var(--current-emotion);
  opacity: 0.3;
  transition: opacity 0.3s var(--ease-arrive);
}

.release-btn.ready:hover::before {
  opacity: 0.5;
}

/* Charging animation during hold */
.release-btn.charging {
  animation: charging-pulse 0.5s var(--ease-breathe) infinite;
}

.release-btn.charging::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 3rem;
  border: 2px solid var(--current-emotion);
  animation: charge-ring 2s linear infinite;
}

@keyframes charging-pulse {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 0 20px var(--current-glow);
  }
  50% {
    transform: scale(1.02);
    box-shadow: 0 0 40px var(--current-glow), 0 0 60px var(--current-ambient);
  }
}

@keyframes charge-ring {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  100% {
    transform: scale(1.3);
    opacity: 0;
  }
}

.btn-content {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-xs);
  z-index: 1;
}

.btn-text {
  font-size: 1.125rem;
  font-weight: 500;
  letter-spacing: 0.02em;
}

.btn-subtitle {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  opacity: 0.7;
}

/* Charge indicator */
.charge-indicator {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 4px;
  border-radius: 0 0 3rem 3rem;
  overflow: hidden;
  opacity: 0;
  transition: opacity 0.3s;
}

.release-btn.charging .charge-indicator {
  opacity: 1;
}

.charge-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, var(--current-emotion), var(--current-peak));
  transition: width 0.1s linear;
}

/* ============================================
   Release Animation Container
   ============================================ */

.release-container {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 200;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.5s var(--ease-arrive);
}

.release-container.active {
  opacity: 1;
}

.text-preview {
  /* Centered in screen, large but not overwhelming */
  font-size: clamp(2rem, 6vw, 4rem);
  font-weight: 600;
  text-align: center;
  max-width: 90%;
  line-height: 1.3;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  transition: all 0.3s var(--ease-arrive);
  white-space: pre-wrap;
  word-break: break-word;
}

/* Phase 1: BUILDING - Text appears and builds tension */
.release-container.building .text-preview {
  animation: build-tension 1s var(--ease-breathe) infinite;
  text-shadow: 0 0 40px currentColor, 0 0 80px currentColor;
  color: var(--current-emotion);
}

@keyframes build-tension {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    filter: brightness(1) blur(0px);
  }
  50% {
    transform: translate(-50%, -50%) scale(1.02);
    filter: brightness(1.3) blur(0px);
  }
}

/* Phase 2: DEFORMING - Text distorts before shattering */
.release-container.deforming .text-preview {
  animation: text-deform 0.8s ease-in forwards;
}

@keyframes text-deform {
  0% {
    transform: translate(-50%, -50%) scale(1) skew(0deg) rotate(0deg);
    filter: brightness(1.3) blur(0px);
    opacity: 1;
  }
  30% {
    transform: translate(-50%, -50%) scale(1.1, 0.9) skew(5deg) rotate(var(--deform-rotate, 2deg));
    filter: brightness(1.5) blur(1px);
    opacity: 1;
  }
  60% {
    transform: translate(-50%, -50%) scale(1.15, 0.85) skew(-3deg) rotate(calc(var(--deform-rotate, 2deg) * -0.5));
    filter: brightness(2) blur(2px) contrast(1.5);
    opacity: 0.9;
  }
  100% {
    transform: translate(-50%, -50%) scale(1.2, 0.8) skew(0deg) rotate(0deg);
    filter: brightness(3) blur(4px) contrast(2);
    opacity: 0.3;
  }
}

/* Phase 3: SHATTERING - Text breaks apart completely */
.release-container.shattering .text-preview {
  animation: text-shatter-explode 0.5s ease-out forwards;
}

@keyframes text-shatter-explode {
  0% {
    transform: translate(-50%, -50%) scale(1.2, 0.8);
    opacity: 0.3;
    filter: blur(4px) brightness(3);
  }
  30% {
    transform: translate(-50%, -50%) scale(1.5, 0.5) rotate(var(--shatter-rotate, 3deg));
    opacity: 0.15;
    filter: blur(8px) brightness(5) contrast(3);
  }
  60% {
    transform: translate(-50%, -50%) scale(2, 0.2) rotate(calc(var(--shatter-rotate, 3deg) * -0.5));
    opacity: 0.05;
    filter: blur(15px) brightness(10);
  }
  100% {
    transform: translate(-50%, -50%) scale(3, 0);
    opacity: 0;
    filter: blur(30px) brightness(20);
  }
}

/* Screen shake for dramatic effect during shatter */
.release-container.shattering {
  animation: screen-shake 0.6s ease-out;
}

@keyframes screen-shake {
  0%, 100% { transform: translate(0, 0); }
  8% { transform: translate(-6px, 3px); }
  16% { transform: translate(6px, -3px); }
  24% { transform: translate(-5px, 2px); }
  32% { transform: translate(5px, -2px); }
  40% { transform: translate(-3px, 1px); }
  48% { transform: translate(3px, -1px); }
  56% { transform: translate(-1px, 0.5px); }
  64% { transform: translate(1px, -0.5px); }
  72% { transform: translate(0, 0); }
}

/* ============================================
   Emotion-Specific Build-up Animations
   ============================================ */

/* ANGER - Violent shaking */
.release-container.building.anger .text-preview {
  animation: anger-shake 0.06s infinite;
  --deform-rotate: 8deg;
  --shatter-rotate: 8deg;
}

@keyframes anger-shake {
  0%, 100% { transform: translateX(-50%) scale(1) rotate(0deg); }
  25% { transform: translateX(calc(-50% - 4px)) scale(1.02) rotate(-2deg); }
  75% { transform: translateX(calc(-50% + 4px)) scale(1.02) rotate(2deg); }
}

/* ANXIETY - Glitchy, erratic */
.release-container.building.anxiety .text-preview {
  animation: anxiety-glitch 0.08s infinite;
  --deform-rotate: 5deg;
  --shatter-rotate: 5deg;
}

@keyframes anxiety-glitch {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1) skew(0deg);
    opacity: 1;
  }
  33% {
    transform: translate(calc(-50% + 3px), -50%) scale(1.03) skew(3deg);
    opacity: 0.85;
  }
  66% {
    transform: translate(calc(-50% - 3px), -50%) scale(0.97) skew(-2deg);
    opacity: 0.9;
  }
}

/* SADNESS - Heavy, sinking feeling */
.release-container.building.sadness .text-preview {
  animation: sadness-heavy 2s var(--ease-breathe) infinite;
  --deform-rotate: 1deg;
  --shatter-rotate: 1deg;
}

@keyframes sadness-heavy {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    filter: brightness(0.95) blur(0px);
  }
  50% {
    transform: translate(-50%, -50%) scale(0.98);
    filter: brightness(0.85) blur(1px);
  }
}

/* FEAR - Trembling */
.release-container.building.fear .text-preview {
  animation: fear-tremble 0.1s infinite;
  --deform-rotate: 3deg;
  --shatter-rotate: 3deg;
}

@keyframes fear-tremble {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
  50% {
    transform: translate(-50%, -50%) scale(1.02);
    opacity: 0.9;
  }
}

/* SHAME - Shrinking away */
.release-container.building.shame .text-preview {
  animation: shame-shrink 1.5s var(--ease-breathe) infinite;
  --deform-rotate: 0deg;
  --shatter-rotate: 0deg;
}

@keyframes shame-shrink {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
  50% {
    transform: translate(-50%, -50%) scale(0.95);
    opacity: 0.85;
  }
}

/* LONELINESS - Fading, drifting */
.release-container.building.loneliness .text-preview {
  animation: loneliness-fade 2s var(--ease-breathe) infinite;
  --deform-rotate: 2deg;
  --shatter-rotate: 2deg;
}

@keyframes loneliness-fade {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
  50% {
    transform: translate(calc(-50% + 4px), -50%) scale(0.98);
    opacity: 0.8;
  }
}

/* AUTO - Gentle pulsing */
.release-container.building.auto .text-preview {
  animation: auto-gentle 1.5s var(--ease-breathe) infinite;
  --deform-rotate: 1deg;
  --shatter-rotate: 1deg;
}

@keyframes auto-gentle {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    filter: brightness(1);
  }
  50% {
    transform: translate(-50%, -50%) scale(1.02);
    filter: brightness(1.2);
  }
}

/* ============================================
   Afterglow Section
   ============================================ */

.afterglow-section {
  text-align: center;
  padding: var(--space-3xl) var(--space-lg);
  animation: fade-in 1.5s var(--ease-arrive) forwards;
}

.afterglow-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-xl);
}

.afterglow-icon {
  font-size: 4rem;
  animation: sun-rise 2s var(--ease-weighted) forwards;
  color: #ffd93d;
  filter: drop-shadow(0 0 20px rgba(255, 217, 61, 0.6));
}

/* SVG Sun Icon */
.sun-icon {
  width: 80px;
  height: 80px;
  color: #ffd93d;
}

.sun-rays {
  transform-origin: center;
  animation: sun-spin 20s linear infinite;
}

.sun-circle {
  animation: sun-pulse 3s ease-in-out infinite;
}

@keyframes sun-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@keyframes sun-pulse {
  0%, 100% { opacity: 0.3; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(1.1); }
}

@keyframes sun-rise {
  0% {
    transform: translateY(30px) scale(0.8);
    opacity: 0;
  }
  100% {
    transform: translateY(0) scale(1);
    opacity: 1;
  }
}

.afterglow-message {
  font-size: 1.25rem;
  font-weight: 300;
  line-height: 1.6;
  color: var(--text-primary);
  max-width: 400px;
  animation: fade-in 1s var(--ease-arrive) 0.5s both;
}

.afterglow-subtitle {
  font-size: 0.875rem;
  color: var(--text-secondary);
  animation: fade-in 1s var(--ease-arrive) 0.8s both;
}

/* Milestone Footer - Small, unobtrusive note */
.milestone-footer {
  margin-top: var(--space-xl);
  font-size: 0.75rem;
  color: var(--text-muted);
  opacity: 0.7;
  animation: fade-in 0.8s var(--ease-arrive) 1.5s both;
}

.reset-btn {
  display: inline-flex;
  align-items: center;
  gap: var(--space-sm);
  padding: var(--space-md) var(--space-xl);
  border: 1px solid rgba(255, 255, 255, 0.15);
  background: rgba(255, 255, 255, 0.05);
  border-radius: 3rem;
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.3s var(--ease-arrive);
  animation: fade-in 1s var(--ease-arrive) 1s both;
}

.reset-btn:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.25);
  transform: translateY(-2px);
}

/* Exhale animation for closure */
.exhale-indicator {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 50;
  opacity: 0;
}

.exhale-indicator.active {
  animation: exhale-breathe 4s var(--ease-breathe) forwards;
}

@keyframes exhale-breathe {
  0% {
    opacity: 0;
    background: radial-gradient(circle, var(--current-peace) 0%, transparent 50%);
  }
  20% {
    opacity: 0.3;
    background: radial-gradient(circle, var(--current-peace) 0%, transparent 60%);
  }
  80% {
    opacity: 0.15;
    background: radial-gradient(circle, var(--current-peace) 0%, transparent 70%);
  }
  100% {
    opacity: 0;
    background: radial-gradient(circle, var(--current-peace) 0%, transparent 80%);
  }
}

/* ============================================
   Footer
   ============================================ */

.footer {
  margin-top: auto;
  padding: var(--space-xl) 0;
  text-align: center;
}

.footer-text {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-weight: 300;
  letter-spacing: 0.02em;
}

/* ============================================
   Sound Toggle
   ============================================ */

.sound-toggle {
  position: fixed;
  bottom: var(--space-lg);
  right: var(--space-lg);
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(255, 255, 255, 0.05);
  border-radius: 50%;
  cursor: pointer;
  z-index: 10;
  transition: all 0.3s var(--ease-arrive);
}

.sound-toggle:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.2);
}

.sound-icon {
  font-size: 1.125rem;
}

/* ============================================
   Animations
   ============================================ */

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fade-in-down {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fade-in-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes gentle-breathe {
  0%, 100% {
    transform: scale(1);
    opacity: 0.9;
  }
  50% {
    transform: scale(1.05);
    opacity: 1;
  }
}

/* ============================================
   Emotion States
   ============================================ */

body[data-emotion="sadness"] {
  --current-emotion: var(--sadness-primary);
  --current-heavy: var(--sadness-heavy);
  --current-peak: var(--sadness-peak);
  --current-peace: var(--sadness-peace);
  --current-glow: var(--sadness-glow);
  --current-ambient: var(--sadness-ambient);
}

body[data-emotion="anger"] {
  --current-emotion: var(--anger-primary);
  --current-heavy: var(--anger-heavy);
  --current-peak: var(--anger-peak);
  --current-peace: var(--anger-peace);
  --current-glow: var(--anger-glow);
  --current-ambient: var(--anger-ambient);
}

body[data-emotion="anxiety"] {
  --current-emotion: var(--anxiety-primary);
  --current-heavy: var(--anxiety-heavy);
  --current-peak: var(--anxiety-peak);
  --current-peace: var(--anxiety-peace);
  --current-glow: var(--anxiety-glow);
  --current-ambient: var(--anxiety-ambient);
}

/* Afterglow peace state - DRAMATICALLY BRIGHTER (4-5x increase for catharsis) */
body[data-state="afterglow"] {
  --current-emotion: var(--current-peace);
  --current-glow: rgba(200, 228, 246, 0.5);
  --current-ambient: rgba(200, 228, 246, 0.2);
  --void-deep: #5b9bd5;      /* Bright sky blue - was #0f1a2a */
  --void-mid: #7bb5e0;
  --void-light: #b0d9f0;
}

/* Afterglow gradient overlay - golden warmth */
body[data-state="afterglow"]::before {
  content: '';
  position: fixed;
  inset: 0;
  background: radial-gradient(
    circle at 50% 30%,
    rgba(255, 245, 230, 0.4) 0%,
    rgba(154, 184, 217, 0.2) 50%,
    transparent 100%
  );
  opacity: 0;
  animation: afterglow-fade-in 3s ease-out forwards;
  pointer-events: none;
  z-index: 0;
}

@keyframes afterglow-fade-in {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

body[data-state="afterglow"] .orb-1,
body[data-state="afterglow"] .orb-2 {
  background: radial-gradient(circle, var(--current-peace) 0%, transparent 70%);
  opacity: 0.7 !important;
}

body[data-state="afterglow"] .orb-3 {
  /* Golden warmth orb for emotional warmth */
  background: radial-gradient(
    circle,
    rgba(255, 236, 179, 0.6) 0%,
    transparent 70%
  ) !important;
  opacity: 0.5 !important;
}

/* Emotion-specific afterglow colors */
body[data-state="afterglow"][data-emotion="sadness"] {
  --void-deep: #5b9bd5;      /* Bright sky blue */
  --text-primary: #ffffff;
}

body[data-state="afterglow"][data-emotion="anger"] {
  --void-deep: #d4956a;      /* Warm peach-gold */
  --text-primary: #ffffff;
}

body[data-state="afterglow"][data-emotion="anxiety"] {
  --void-deep: #9b7cc4;      /* Bright lavender */
  --text-primary: #ffffff;
}

body[data-state="afterglow"][data-emotion="fear"] {
  --void-deep: #7db58a;      /* Calming green */
  --text-primary: #ffffff;
}

body[data-state="afterglow"][data-emotion="shame"] {
  --void-deep: #c9a86a;      /* Warm gold */
  --text-primary: #ffffff;
}

body[data-state="afterglow"][data-emotion="loneliness"] {
  --void-deep: #d4a5c9;      /* Warm pink */
  --text-primary: #ffffff;
}

/* Default afterglow */
body[data-state="afterglow"] {
  --text-primary: #ffffff;
  --text-secondary: #f0f4ff;
}

/* ============================================
   New Emotion States
   ============================================ */

body[data-emotion="fear"] {
  --current-emotion: var(--fear-primary);
  --current-heavy: var(--fear-heavy);
  --current-peak: var(--fear-peak);
  --current-peace: var(--fear-peace);
  --current-glow: var(--fear-glow);
  --current-ambient: var(--fear-ambient);
}

body[data-emotion="shame"] {
  --current-emotion: var(--shame-primary);
  --current-heavy: var(--shame-heavy);
  --current-peak: var(--shame-peak);
  --current-peace: var(--shame-peace);
  --current-glow: var(--shame-glow);
  --current-ambient: var(--shame-ambient);
}

body[data-emotion="loneliness"] {
  --current-emotion: var(--loneliness-primary);
  --current-heavy: var(--loneliness-heavy);
  --current-peak: var(--loneliness-peak);
  --current-peace: var(--loneliness-peace);
  --current-glow: var(--loneliness-glow);
  --current-ambient: var(--loneliness-ambient);
}

/* ============================================
   Accessibility - Screen Reader Only
   ============================================ */

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* ============================================
   Alternative Release Button
   ============================================ */

.alt-release-container {
  margin-top: var(--space-md);
  display: flex;
  justify-content: center;
}

.alt-release-btn {
  padding: var(--space-sm) var(--space-lg);
  border: 1px dashed rgba(255, 255, 255, 0.2);
  background: rgba(255, 255, 255, 0.02);
  border-radius: 2rem;
  color: var(--text-muted);
  font-family: inherit;
  font-size: 0.875rem;
  cursor: not-allowed;
  transition: all 0.3s var(--ease-arrive);
  opacity: 0.6;
}

.alt-release-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.alt-release-btn.ready {
  cursor: pointer;
  background: rgba(255, 255, 255, 0.05);
  color: var(--text-secondary);
  opacity: 1;
}

.alt-release-btn.ready:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.3);
}

.alt-release-btn.counting {
  border-color: var(--current-emotion);
  color: var(--current-emotion);
  animation: countdown-pulse 1s ease-in-out infinite;
}

@keyframes countdown-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

.release-countdown {
  font-weight: 600;
  color: var(--current-emotion);
}

/* ============================================
   Crisis Support Resources
   ============================================ */

.crisis-support {
  margin-top: var(--space-2xl);
  padding: var(--space-lg);
  background: rgba(255, 255, 255, 0.05);
  border-radius: 1rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
  animation: fade-in 1s var(--ease-arrive) 1.5s both;
}

.crisis-text {
  font-size: 0.875rem;
  color: var(--text-secondary);
  margin-bottom: var(--space-md);
  text-align: center;
}

.crisis-links {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
  align-items: center;
}

.crisis-link {
  padding: var(--space-sm) var(--space-md);
  color: var(--text-primary);
  text-decoration: none;
  font-size: 0.875rem;
  border-radius: 0.5rem;
  transition: all 0.2s var(--ease-arrive);
  background: rgba(255, 255, 255, 0.05);
}

.crisis-link:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-1px);
}

.crisis-link:focus-visible {
  outline: 2px solid var(--current-emotion);
  outline-offset: 2px;
}

/* ============================================
   Keyboard Shortcuts Modal
   ============================================ */

.keyboard-modal {
  margin: auto;
  padding: 0;
  border: none;
  background: transparent;
  max-width: 400px;
  width: 90%;
}

.keyboard-modal::backdrop {
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(4px);
}

.keyboard-modal-content {
  background: var(--void-mid);
  border-radius: 1rem;
  padding: var(--space-xl);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.keyboard-modal-content h2 {
  font-size: 1.25rem;
  font-weight: 500;
  margin-bottom: var(--space-lg);
  color: var(--text-primary);
}

.keyboard-list {
  list-style: none;
  padding: 0;
  margin: 0 0 var(--space-xl) 0;
}

.keyboard-list li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-sm) 0;
  color: var(--text-secondary);
  font-size: 0.875rem;
}

kbd {
  display: inline-block;
  padding: 0.2rem 0.5rem;
  font-size: 0.75rem;
  font-family: monospace;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 0.3rem;
  color: var(--text-primary);
}

.modal-close {
  width: 100%;
  padding: var(--space-md);
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(255, 255, 255, 0.05);
  border-radius: 0.5rem;
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s var(--ease-arrive);
}

.modal-close:hover {
  background: rgba(255, 255, 255, 0.1);
}

/* ============================================
   Motion Toggle Button
   ============================================ */

.motion-toggle {
  position: fixed;
  bottom: var(--space-lg);
  left: var(--space-lg);
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(255, 255, 255, 0.05);
  border-radius: 50%;
  cursor: pointer;
  z-index: 10;
  transition: all 0.3s var(--ease-arrive);
}

.motion-toggle:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.2);
}

.motion-icon {
  font-size: 1.125rem;
}

.motion-toggle.active {
  background: var(--current-emotion);
  border-color: var(--current-emotion);
}

/* ============================================
   Keyboard Hint in Footer
   ============================================ */

.keyboard-hint {
  font-size: 0.7rem;
  color: var(--text-muted);
  margin-top: var(--space-sm);
}

/* ============================================
   Reduced Motion Mode
   ============================================ */

body.reduce-motion * {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
}

body.reduce-motion .sun-rays,
body.reduce-motion .sun-circle {
  animation: none !important;
}

/* ============================================
   Emotional Journey Stages - MORE PROMINENT
   ============================================ */

.journey-stages {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-md);
  margin-top: var(--space-xl);
  padding: var(--space-md) var(--space-lg);
  background: rgba(255, 255, 255, 0.05);
  border-radius: 2rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
  animation: fade-in 1s var(--ease-arrive) 0.3s both;
}

.journey-stage {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0;
  opacity: 0.4;
  transition: all 0.5s var(--ease-arrive);
  position: relative;
  min-width: 60px;
}

.journey-stage.active {
  opacity: 1;
  transform: scale(1.15);
}

.journey-stage.active::after {
  content: '';
  position: absolute;
  inset: -8px;
  border-radius: 50%;
  background: radial-gradient(circle, var(--current-emotion) 0%, transparent 70%);
  animation: stage-glow 2s ease-in-out infinite;
  z-index: -1;
}

@keyframes stage-glow {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}

.journey-stage.completed {
  opacity: 0.7;
}

.journey-stage.completed .stage-icon {
  filter: grayscale(0);
  opacity: 0.7;
}

.stage-icon {
  font-size: 1.5rem;
  filter: grayscale(0.5);
  transition: all 0.3s;
}

.journey-stage.active .stage-icon {
  filter: grayscale(0);
  transform: scale(1.1);
}

.stage-label {
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-muted);
  transition: color 0.3s;
  margin-top: 2px;
}

.journey-stage.active .stage-label {
  color: var(--current-emotion);
}

.journey-arrow {
  color: var(--text-muted);
  opacity: 0.5;
  font-size: 1.25rem;
}

/* ============================================
   Release Counter
   ============================================ */

.release-counter {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-sm);
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-top: var(--space-sm);
}

.counter-icon {
  font-size: 0.875rem;
}

.counter-text strong {
  color: var(--current-emotion);
  font-weight: 600;
}

/* ============================================
   Enhanced Micro-interactions
   ============================================ */

/* Emoji bounce on emotion select */
.emotion-btn.active .emotion-icon {
  animation: emoji-bounce 0.5s ease-out;
}

@keyframes emoji-bounce {
  0% { transform: scale(1); }
  30% { transform: scale(1.4) rotate(10deg); }
  60% { transform: scale(0.9) rotate(-5deg); }
  100% { transform: scale(1) rotate(0deg); }
}

/* Emotion icon hover effect */
.emotion-btn:hover .emotion-icon {
  transform: scale(1.15) rotate(5deg);
  transition: transform 0.3s var(--ease-weighted);
}

/* Ready button pulse */
.release-btn.ready {
  animation: ready-pulse 2s ease-in-out infinite;
}

@keyframes ready-pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 var(--current-glow);
  }
  50% {
    box-shadow: 0 0 0 8px transparent;
  }
}

/* Charging state enhancement */
.release-btn.charging {
  animation: charging-glow 0.5s ease-in-out infinite;
}

@keyframes charging-glow {
  0%, 100% {
    box-shadow: 0 0 20px var(--current-glow), 0 0 40px var(--current-ambient);
  }
  50% {
    box-shadow: 0 0 30px var(--current-glow), 0 0 60px var(--current-ambient);
  }
}

/* Input well ambient particles hint */
.emotion-well:focus-within::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 1.5rem;
  background: radial-gradient(circle at 50% 50%, var(--current-ambient) 0%, transparent 70%);
  opacity: 0.5;
  pointer-events: none;
  animation: well-pulse 3s ease-in-out infinite;
}

@keyframes well-pulse {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.5; }
}

/* Enhanced emotion button active state */
.emotion-btn.active {
  position: relative;
}

.emotion-btn.active::after {
  content: '';
  position: absolute;
  bottom: -4px;
  left: 50%;
  transform: translateX(-50%);
  width: 20px;
  height: 2px;
  background: var(--current-emotion);
  border-radius: 2px;
  animation: active-indicator-grow 0.3s ease-out forwards;
}

@keyframes active-indicator-grow {
  0% { width: 0; }
  100% { width: 20px; }
}

/* Logo animation enhancement */
.logo-icon {
  animation: logo-gentle-breathe 4s ease-in-out infinite;
}

@keyframes logo-gentle-breathe {
  0%, 100% {
    transform: scale(1) rotate(0deg);
  }
  50% {
    transform: scale(1.05) rotate(5deg);
  }
}

body.reduce-motion .gradient-orb {
  animation: none !important;
}

/* ============================================
   Responsive Design
   ============================================ */

@media (max-width: 640px) {
  .container {
    padding: var(--space-lg) var(--space-md);
  }

  .header {
    padding: var(--space-xl) 0 var(--space-lg);
  }

  .logo-text {
    font-size: 1.25rem;
  }

  .emotion-btn {
    padding: var(--space-xs) var(--space-sm);
    flex: 1;
    min-width: 70px;
  }

  .emotion-label {
    font-size: 0.65rem;
  }

  .emotion-well {
    padding: var(--space-lg);
  }

  .well-border.top,
  .well-border.bottom {
    left: var(--space-md);
    right: var(--space-md);
  }

  .well-border.left,
  .well-border.right {
    top: var(--space-md);
    bottom: var(--space-md);
  }

  .emotion-input {
    font-size: 1rem;
    min-height: 150px;
  }

  .btn-text {
    font-size: 1rem;
  }

  .sound-toggle {
    bottom: var(--space-md);
    right: var(--space-md);
  }
}
